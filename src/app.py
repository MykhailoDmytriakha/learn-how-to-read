import streamlit as st
import json
import logging
import os
from syllable_processor import process_text
from text_complexity import calculate_text_complexity

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# Add this at the top of the file with other imports
READ_STATUS_FILE = "read_status.json"

# Sample phrases
SAMPLE_PHRASES = [
    "–ú–∞–º–∞ –º—ã–ª–∞ —Ä–∞–º—É.",
    "–°–∞—à–∞ –µ—Å—Ç –∫–∞—à—É.",
    "–ù–∞ —Ä–µ–∫–µ —Ä—ã–±–∞–∫–∏.",
    "–ú–∞–º–∞ –ª—é–±–∏—Ç –ø–∞–ø—É. –ü–∞–ø–∞ –ª—é–±–∏—Ç –º–∞–º—É.",
    "–ú–∞–º–∞ –≥–æ—Ç–æ–≤–∏—Ç —Å—É–ø. –ü–∞–ø–∞ —á–∏—Ç–∞–µ—Ç –∫–Ω–∏–≥—É.",
    "–ù–∞ —É–ª–∏—Ü–µ –¥–µ—Ç–∏ –∏–≥—Ä–∞—é—Ç. –î–∞–Ω–∏–∏–ª –∏–≥—Ä–∞–µ—Ç –≤ –º—è—á.",
    "–°–µ–≥–æ–¥–Ω—è —Ö–æ—Ä–æ—à–∞—è –ø–æ–≥–æ–¥–∞. –Ø –ª—é–±–ª—é –∫—É—à–∞—Ç—å –º–æ—Ä–æ–∂–µ–Ω–æ–µ.",
    "–ú—ã –¥—Ä—É–∂–Ω–∞—è —Å–µ–º—å—è.",
    "–ù–∞–æ–º–∏ –µ–¥–µ—Ç –Ω–∞ –≤–µ–ª–æ—Å–∏–ø–µ–¥–µ. –û–ª–µ–≥ –∏–≥—Ä–∞–µ—Ç –º–∞—à–∏–Ω–∫–∞–º–∏. –í—Å–µ –≤–µ—Å–µ–ª—è—Ç—Å—è –∏ —Å–º–µ—é—Ç—Å—è.",
    "–ö–æ—à–∫–∞ –ø—å—ë—Ç –º–æ–ª–æ–∫–æ. –î–µ—Ç–∏ –∏–≥—Ä–∞—é—Ç –≤ –ø–∞—Ä–∫–µ. –ú—ã –ª—é–±–∏–º –ª–µ—Ç–æ.",
    "–ö–æ—Ç —Å–ø–∏—Ç —Ç—É—Ç.",
    "–î–æ–º –≤—ã—Å–æ–∫–∏–π.",
    "–ú—è—á –ª–µ—Ç–∏—Ç –≤–≤–µ—Ä—Ö.",
    "–°–æ–ª–Ω—Ü–µ —Å–≤–µ—Ç–∏—Ç —è—Ä–∫–æ.",
    "–õ—É–Ω–∞ —Å–≤–µ—Ç–∏—Ç –Ω–æ—á—å—é.",
    "–†—ã–±–∞ –≤ –≤–æ–¥–µ.",
    "–Å–∂ –≤ —Ç—Ä–∞–≤–µ.",
    "–î—ã–º –∏–¥—ë—Ç –≤–≤–µ—Ä—Ö.",
    "–ú–∞–º–∞ –∏ –ø–∞–ø–∞ –¥–æ–º–∞.",
    "–°–æ–±–∞–∫–∞ –ª–∞–µ—Ç, –∞ –∫–æ—Ç –±–µ–∂–∏—Ç.",
    "–Ø —Ä–∏—Å—É—é –∏ —Ç—ã —Ä–∏—Å—É–µ—à—å.",
    "–ë–∞–±—É—à–∫–∞ –≤—è–∂–µ—Ç —à–∞—Ä—Ñ, –∞ –¥–µ–¥—É—à–∫–∞ —á–∏—Ç–∞–µ—Ç.",
    "–ë–æ–ª—å—à–æ–π —Å–ª–æ–Ω —Å—Ç–æ–∏—Ç –≤ –∑–æ–æ–ø–∞—Ä–∫–µ.",
    "–ö—Ä–∞—Å–Ω–∞—è –º–∞—à–∏–Ω–∞ –µ–¥–µ—Ç –±—ã—Å—Ç—Ä–æ.",
    "–ñ—ë–ª—Ç—ã–π —Ü—ã–ø–ª—ë–Ω–æ–∫ –∫–ª—é—ë—Ç –∑—ë—Ä–Ω–∞.",
    "–í–∫—É—Å–Ω—ã–π —Å—É–ø –≤ –∫–∞—Å—Ç—Ä—é–ª–µ.",
    "–£—Ä–∞! –î–æ–∂–¥—å –∏–¥—ë—Ç!",
    "–û–π! –ú—è—á —É–ø–∞–ª!",
    "–ö—Ç–æ —Ç—É—Ç? –≠—Ç–æ —è!",
    "–ú–∞–º–∞ –≥–æ–≤–æ—Ä–∏—Ç: ¬´–ü–æ—Ä–∞ —Å–ø–∞—Ç—å¬ª. –ü–∞–ø–∞ –≥–æ–≤–æ—Ä–∏—Ç: ¬´–°–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏¬ª.",
    "–ó–∏–º–æ–π –ø–∞–¥–∞–µ—Ç —Å–Ω–µ–≥. –î–µ—Ç–∏ –ª–µ–ø—è—Ç —Å–Ω–µ–≥–æ–≤–∏–∫–∞.",
    "–õ–µ—Ç–æ–º –∂–∞—Ä–∫–æ. –ú—ã –∫—É–ø–∞–µ–º—Å—è –≤ —Ä–µ—á–∫–µ.",
    "–£—Ç—Ä–æ–º —è —É–º—ã–≤–∞—é—Å—å. –í–µ—á–µ—Ä–æ–º —á–∏—â—É –∑—É–±—ã.",
    "–ú—É—Ä–∞–≤–µ–π –Ω–∞—à–µ–ª –±–æ–ª—å—à–æ–µ –∑–µ—Ä–Ω–æ. –û–Ω –Ω–µ –º–æ–≥ —Ç–∞—â–∏—Ç—å –µ–≥–æ –æ–¥–∏–Ω.",
    "–ú—É—Ä–∞–≤–µ–π –ø–æ–∑–≤–∞–ª –Ω–∞ –ø–æ–º–æ—â—å —Ç–æ–≤–∞—Ä–∏—â–µ–π. –í–º–µ—Å—Ç–µ –º—É—Ä–∞–≤—å–∏ –ª–µ–≥–∫–æ –ø—Ä–∏—Ç–∞—â–∏–ª–∏ –∑–µ—Ä–Ω–æ –≤ –º—É—Ä–∞–≤–µ–π–Ω–∏–∫.",
    "–î–æ–ª–≥–æ —Å–∏–¥–µ–ª —è —Å —É–¥–æ—á–∫–æ–π –Ω–∞ –±–µ—Ä–µ–≥—É. –ù–µ –∫–ª—é—é—Ç —É –º–µ–Ω—è –ø–µ—Å–∫–∞—Ä–∏.",
    "–ê –¥–µ–¥ –ø–æ–¥ –∫—É—Å—Ç–∏–∫–æ–º —Å–∏–¥–∏—Ç –∏ —É–∂–µ –≤–µ–¥–µ—Ä–∫–æ –Ω–∞–ª–æ–≤–∏–ª. –°–µ–ª –∏ —è –≤ —Ç–µ–Ω–∏. –°—Ä–∞–∑—É –ø–µ—Å–∫–∞—Ä–∏ –∫–ª–µ–≤–∞—Ç—å —Å—Ç–∞–ª–∏.", 
    "–û–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –Ω–∞ —á–∏—Å—Ç–æ–º –º–µ—Å—Ç–µ —Ç–µ–Ω—å –æ—Ç —É–¥–æ—á–∫–∏ –≤–∏–¥–Ω–∞. –í–æ—Ç –∏ –Ω–µ —à–ª–∞ –∫ –∫—Ä—é—á–∫—É —Ö–∏—Ç—Ä–∞—è —Ä—ã–±–∞. ",
    "–ö–∞—Ç–µ –¥–∞–ª–∏ –º—ã–ª–æ. –û–Ω–∞ –º—ã–ª–∞ —Ä—É–∫–∏, –ª–∏—Ü–æ –∏ —à–µ—é. –†—É–∫–∏, –ª–∏—Ü–æ –∏ —à–µ—è –±—ã–ª–∏ –±–µ–ª—ã.",
    "–ü–∞–ø–∞ –¥–æ–º–∞ –∏ –í–∏—Ç—è –¥–æ–º–∞. –ù–µ —à—É–º–∏, –í–∏—Ç—è, –Ω–µ –±—É–¥–∏ –ø–∞–ø—É, –∞ —Å–∏–¥–∏ —Ç–∏—Ö–æ. –õ—é–±–∏, –í–∏—Ç—è, –ø–∞–ø—É.",
    "–î–∞–Ω–∏–ª –±–µ–∂–∏—Ç –±—ã—Å—Ç—Ä–æ!", 
    "–ú—è—á –ª–µ—Ç–∏—Ç –≤–≤–µ—Ä—Ö!",
    "–ò–≥—Ä–∞–µ–º –≤ –¥–æ–≥–æ–Ω—è–ª–∫–∏!",
    "–ö–∞—á–µ–ª–∏ –ª–µ—Ç—è—Ç –≤—ã—Å–æ–∫–æ.",
    "–î–∞–Ω–∏–ª —Å–º–µ—ë—Ç—Å—è –≥—Ä–æ–º–∫–æ.",
    "–°–æ–±–∞–∫–∞ –≤–∏–ª—è–µ—Ç —Ö–≤–æ—Å—Ç–æ–º.",
    "–°–æ–ª–Ω—Ü–µ —Å–≤–µ—Ç–∏—Ç —è—Ä–∫–æ.",
    "–ú—ã –ø—Ä—ã–≥–∞–µ–º –Ω–∞ –∫—Ä–æ–≤–∞—Ç–∏.",  
    "–í–µ–¥—Ä–æ —Å –ø–µ—Å–∫–æ–º —Ç—è–∂—ë–ª–æ–µ.",
    "–ü–∞–ø–∞ –∫–∞—Ç–∏—Ç –º–∞—à–∏–Ω–∫—É.",
    "–î–∞–Ω–∏–ª —Å—Ç—Ä–æ–∏—Ç –≤—ã—Å–æ–∫—É—é –±–∞—à–Ω—é –∏–∑ –∫—É–±–∏–∫–æ–≤.", 
    "–ú—ã –∑–∞–ø—É—Å–∫–∞–µ–º –≤–æ–∑–¥—É—à–Ω–æ–≥–æ –∑–º–µ—è –≤ –ø–∞—Ä–∫–µ.",
    "–ì–æ—Ä—è—á–∏–π —à–∞—Ä–∏–∫ –ª–æ–ø–Ω—É–ª —Å —Ç—Ä–µ—Å–∫–æ–º!",
    "–ù–∞ —Ä–æ–ª–∏–∫–∞—Ö –∫–∞—á—É—Å—å –±—ã—Å—Ç—Ä–æ-–±—ã—Å—Ç—Ä–æ!",
    "–í–µ—Å—ë–ª—ã–µ –±—Ä—ã–∑–≥–∏ –≤ –±–∞—Å—Å–µ–π–Ω–µ.",  
    "–ü—Ä—è—á–µ–º—Å—è –∑–∞ –±–æ–ª—å—à–∏–º –¥–µ—Ä–µ–≤–æ–º.",
    "–°–æ–±–∏—Ä–∞–µ–º –ø–∞–∑–ª –Ω–∞ –ø–æ–ª—É.",
    "–°–ª–∞–¥–∫–∞—è –∫–ª—É–±–Ω–∏–∫–∞ –≤ –∫–æ—Ä–∑–∏–Ω–∫–µ.",
    "–ú—è—á–∏–∫ –∑–∞–∫–∞—Ç–∏–ª—Å—è –ø–æ–¥ –¥–∏–≤–∞–Ω.",
    "–î–æ–∂–¥—å! –ë–µ–∂–∏–º –¥–æ–º–æ–π –±—ã—Å—Ç—Ä–æ!",
    "–î–∞–Ω–∏–ª –æ–±—ä–µ–∑–∂–∞–µ—Ç –ª—É–∂–∏ –Ω–∞ –≤–µ–ª–æ—Å–∏–ø–µ–¥–µ.", 
    "–†–∞–∑–Ω–æ—Ü–≤–µ—Ç–Ω—ã–µ –º–µ–ª–∫–∏ —Ä–∏—Å—É—é—Ç —Ä–∞–¥—É–≥—É.", 
    "–í–µ—Å—ë–ª–∞—è –≥–æ–Ω–∫–∞ —Å –¥—Ä—É–∑—å—è–º–∏ –≤–æ –¥–≤–æ—Ä–µ.",
    "–ü—Ä—ã–∂–∫–∏ —á–µ—Ä–µ–∑ —Å–∫–∞–∫–∞–ª–∫—É: —Ä–∞–∑-–¥–≤–∞-—Ç—Ä–∏!",
    "–°—Ç—Ä–æ–∏–º —Å–µ–∫—Ä–µ—Ç–Ω—É—é –±–∞–∑—É –∏–∑ –æ–¥–µ—è–ª.",
    "–°—ä–µ—Ö–∞–ª —Å –≥–æ—Ä–∫–∏ ‚Äî —É—Ä–∞! ‚Äî –≤ —Å—É–≥—Ä–æ–±.",
    "–§—É—Ç–±–æ–ª—å–Ω—ã–π –º–∞—Ç—á: –≥–æ–ª –∑–∞–±–∏–ª –î–∞–Ω–∏–ª–∫–∞!",
    "–ü—Ä—è—Ç–∫–∏: –∫—Ç–æ —Å–ø—Ä—è—Ç–∞–ª—Å—è –∑–∞ —à—Ç–æ—Ä–æ–π?",
    "–ú—ã–ª—å–Ω—ã–µ –ø—É–∑—ã—Ä–∏ –ª–µ—Ç—è—Ç –∫ –æ–±–ª–∞–∫–∞–º.",
    "–ü–∏—Ä–æ–≥ —Å —è–±–ª–æ–∫–∞–º–∏ –ø–∞—Ö–Ω–µ—Ç –≤–∫—É—Å–Ω–æ.",
    "–î–∞–Ω–∏–ª –∏–≥—Ä–∞–µ—Ç —Å –º—è—á–æ–º.",
    "–î–µ—Ä–µ–≤–æ —Ä–∞—Å—Ç—ë—Ç –≤ —Å–∞–¥—É.",
    "–î–æ–∂–¥—å –∏–¥—ë—Ç, –∏ –º—ã –ø–æ–¥ –∑–æ–Ω—Ç–æ–º.",
    "–î–µ–¥—É—à–∫–∞ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫–∞–∑–∫–∏.",
    "–î–µ–≤–æ—á–∫–∞ —Ä–∏—Å—É–µ—Ç –Ω–∞ –±—É–º–∞–≥–µ.",
    "–î–æ—Ä–æ–≥–∞ –≤–µ–¥—ë—Ç –∫ —Ä–µ–∫–µ.",
    "–î—Ä—É–∑—å—è –∏–≥—Ä–∞—é—Ç –≤ –ø–∞—Ä–∫–µ.",
    "–î–æ–º–∞ —Ç–µ–ø–ª–æ –∏ —É—é—Ç–Ω–æ.",
    "–î–µ–Ω—å —Å–æ–ª–Ω–µ—á–Ω—ã–π –∏ —è—Å–Ω—ã–π.",
    "–î–µ—Ç–∏ —Å–º–µ—é—Ç—Å—è –∏ –∏–≥—Ä–∞—é—Ç.",
    "–ú–∞–º–∞ –º—ã–ª–∞ —Ä–∞–º—É –º—ã–ª—å–Ω–æ–π –ø–µ–Ω–æ–π.",
    "–°–∞—à–∞ –µ—Å—Ç –≥–æ—Ä—è—á—É—é –∫–∞—à—É —Å –º–∞—Å–ª–æ–º.",
    "–†—ã–±–∞–∫–∏ —Å–∏–¥—è—Ç —Å —É–¥–æ—á–∫–∞–º–∏ –Ω–∞ —Ä–µ–∫–µ.",
    "–ú–∞–º–∞ –∏ –ø–∞–ø–∞ –æ–±–Ω–∏–º–∞—é—Ç—Å—è –Ω–∞ –∫—É—Ö–Ω–µ.",
    "–ü–∞–ø–∞ —á–∏—Ç–∞–µ—Ç –¥–µ—Ç—è–º —Å–∫–∞–∑–∫—É –ø–µ—Ä–µ–¥ —Å–Ω–æ–º.",
    "–î–∞–Ω–∏–∏–ª –±—Ä–æ—Å–∞–µ—Ç –º—è—á –≤ –±–∞—Å–∫–µ—Ç–±–æ–ª—å–Ω–æ–µ –∫–æ–ª—å—Ü–æ.",
    "–Ø –µ–º –∫–ª—É–±–Ω–∏—á–Ω–æ–µ –º–æ—Ä–æ–∂–µ–Ω–æ–µ –≤ –≤–∞—Ñ–µ–ª—å–Ω–æ–º —Å—Ç–∞–∫–∞–Ω—á–∏–∫–µ.",
    "–ú—ã –≤—Å–µ–π —Å–µ–º—å—ë–π –∏–≥—Ä–∞–µ–º –≤ –Ω–∞—Å—Ç–æ–ª—å–Ω—É—é –∏–≥—Ä—É.",
    "–ù–∞–æ–º–∏ –∫—Ä—É—Ç–∏—Ç –ø–µ–¥–∞–ª–∏ —Å–∏–Ω–µ–≥–æ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞.",
    "–ü—É—à–∏—Å—Ç—ã–π –∫–æ—Ç –ª–∞–∫–∞–µ—Ç –º–æ–ª–æ–∫–æ –∏–∑ –º–∏—Å–∫–∏.",
    "–†—ã–∂–∏–π –∫–æ—Ç —Å–ø–∏—Ç –Ω–∞ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫–µ.",
    "–í—ã—Å–æ–∫–∏–π –¥–æ–º —Å –∫—Ä–∞—Å–Ω–æ–π –∫—Ä—ã—à–µ–π —Å—Ç–æ–∏—Ç –Ω–∞ –≥–æ—Ä–∫–µ.",
    "–ú—è—á –≤–∑–ª–µ—Ç–∞–µ—Ç –≤–≤–µ—Ä—Ö –∫ –æ–±–ª–∞–∫–∞–º.",
    "–Ø—Ä–∫–æ–µ —Å–æ–ª–Ω—Ü–µ –æ—Å–≤–µ—â–∞–µ—Ç –∑–µ–ª—ë–Ω–æ–µ –ø–æ–ª–µ.",
    "–°–µ—Ä–µ–±—Ä–∏—Å—Ç–∞—è –ª—É–Ω–∞ —Å–≤–µ—Ç–∏—Ç –≤ –Ω–æ—á–Ω–æ–º –æ–∫–Ω–µ.",
    "–ó–æ–ª–æ—Ç–∞—è —Ä—ã–±–∫–∞ –ø–ª–∞–≤–∞–µ—Ç –≤ –∫—Ä—É–≥–ª–æ–º –∞–∫–≤–∞—Ä–∏—É–º–µ.",
    "–ö–æ–ª—é—á–∏–π —ë–∂–∏–∫ –±–µ–∂–∏—Ç —á–µ—Ä–µ–∑ –ª–µ—Å–Ω—É—é —Ç—Ä–æ–ø–∏–Ω–∫—É.",
    "–°–µ—Ä—ã–π –¥—ã–º –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –∏–∑ —Ç—Ä—É–±—ã –¥–æ–º–∞.",
    "–ú–∞–º–∞ –ø–µ—á—ë—Ç —è–±–ª–æ—á–Ω—ã–π –ø–∏—Ä–æ–≥ –∫ —á–∞—é.",
    "–°–æ–±–∞–∫–∞ –≥—Ä–æ–º–∫–æ –ª–∞–µ—Ç –Ω–∞ –ø—Ä–æ–µ–∑–∂–∞—é—â—É—é –º–∞—à–∏–Ω—É.",
    "–Ø —Ä–∏—Å—É—é —Ä–∞–¥—É–≥—É —Ü–≤–µ—Ç–Ω—ã–º–∏ –∫–∞—Ä–∞–Ω–¥–∞—à–∞–º–∏.",
    "–ë–∞–±—É—à–∫–∞ –≤—è–∂–µ—Ç —Ç—ë–ø–ª—ã–π —à–∞—Ä—Ñ –∏–∑ —à–µ—Ä—Å—Ç–∏.",
    "–ë–æ–ª—å—à–æ–π —Å–ª–æ–Ω –µ—Å—Ç —Å–µ–Ω–æ –≤ –∑–æ–æ–ø–∞—Ä–∫–µ.",
    "–ö—Ä–∞—Å–Ω–∞—è –≥–æ–Ω–æ—á–Ω–∞—è –º–∞—à–∏–Ω–∞ –º—á–∏—Ç—Å—è –ø–æ —Ç—Ä–∞—Å—Å–µ.",
    "–ñ—ë–ª—Ç—ã–π —Ü—ã–ø–ª—ë–Ω–æ–∫ –∫–ª—é—ë—Ç –∑—ë—Ä–Ω—ã—à–∫–∏ –≤–æ –¥–≤–æ—Ä–µ.",
    "–ê—Ä–æ–º–∞—Ç–Ω—ã–π —Å—É–ø —Å –æ–≤–æ—â–∞–º–∏ —Å—Ç–æ–∏—Ç –Ω–∞ –ø–ª–∏—Ç–µ.",
    "–î–æ–∂–¥–µ–≤—ã–µ –∫–∞–ø–ª–∏ –±–∞—Ä–∞–±–∞–Ω—è—Ç –ø–æ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫—É.",
    "–†–µ–∑–∏–Ω–æ–≤—ã–π –º—è—á —É–ø–∞–ª –≤ –ª—É–∂—É —Å –±—Ä—ã–∑–≥–∞–º–∏.",
    "–ó–∞ –¥–≤–µ—Ä—å—é —Å–ª—ã—à–µ–Ω –≤–µ—Å—ë–ª—ã–π —Å–º–µ—Ö –¥–µ—Ç–µ–π.",
    "–ú–∞–º–∞ –∑–∞–∂–∏–≥–∞–µ—Ç –Ω–æ—á–Ω–∏–∫ –≤ –¥–µ—Ç—Å–∫–æ–π –∫–æ–º–Ω–∞—Ç–µ.",
    "–î–µ—Ç–∏ –ª–µ–ø—è—Ç —Å–Ω–µ–≥–æ–≤–∏–∫–∞ —Å –º–æ—Ä–∫–æ–≤–Ω—ã–º –Ω–æ—Å–æ–º.",
    "–ú—ã –Ω—ã—Ä—è–µ–º –≤ –ø—Ä–æ—Ö–ª–∞–¥–Ω—É—é —Ä–µ—á–Ω—É—é –≤–æ–¥—É.",
    "–Ø —á–∏—â—É –∑—É–±—ã –ø–∞—Å—Ç–æ–π —Å –º—è—Ç–Ω—ã–º –≤–∫—É—Å–æ–º.",
    "–ú—É—Ä–∞–≤–µ–π —Ç–∞—â–∏—Ç –≤–µ—Ç–æ—á–∫—É –≤ —Å–≤–æ–π –º—É—Ä–∞–≤–µ–π–Ω–∏–∫.",
    "–°—Ç–∞—Ä–∏–∫ –ª–æ–≤–∏—Ç —Å–µ—Ä–µ–±—Ä–∏—Å—Ç—ã—Ö –ø–µ—Å–∫–∞—Ä–µ–π –Ω–∞ —É–¥–æ—á–∫—É.",
    "–î–µ–≤–æ—á–∫–∞ –Ω–∞–º—ã–ª–∏–≤–∞–µ—Ç —Ä—É–∫–∏ –¥—É—à–∏—Å—Ç—ã–º –º—ã–ª–æ–º.",
    "–ú–∞–ª—å—á–∏–∫ —Ç–∏—Ö–æ —Å–æ–±–∏—Ä–∞–µ—Ç –ø–∞–∑–ª –Ω–∞ –∫–æ–≤—Ä–µ.",
    "–î–∞–Ω–∏–ª –±–µ–∂–∏—Ç –±—ã—Å—Ç—Ä–µ–µ –≤—Å–µ—Ö –Ω–∞ —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–µ.",
    "–í–æ–∑–¥—É—à–Ω—ã–π –∑–º–µ–π –ø–∞—Ä–∏—Ç –≤—ã—Å–æ–∫–æ –Ω–∞–¥ –ø–∞—Ä–∫–æ–º.",
    "–õ–æ–ø–Ω—É–≤—à–∏–π —à–∞—Ä–∏–∫ –∏—Å–ø—É–≥–∞–ª —Å–ø—è—â–µ–≥–æ –∫–æ—Ç–∞.",
    "–†–æ–ª–∏–∫–∏ –≥—Ä–æ–º–∫–æ —Å—Ç—É—á–∞—Ç –ø–æ –∞—Å—Ñ–∞–ª—å—Ç–æ–≤–æ–π –¥–æ—Ä–æ–∂–∫–µ.",
    "–î–µ—Ç–∏ –ø—Ä—ã–≥–∞—é—Ç –≤ –±–∞—Å—Å–µ–π–Ω —Å —Ä–∞–∑–Ω–æ—Ü–≤–µ—Ç–Ω—ã–º–∏ –∫—Ä—É–≥–∞–º–∏.",
    "–ú–∞–ª—å—á–∏–∫ –ø—Ä—è—á–µ—Ç—Å—è –∑–∞ —Ç–æ–ª—Å—Ç—ã–º –¥—É–±–æ–º –≤ –ø—Ä—è—Ç–∫–∞—Ö.",
    "–ö–æ—Ä–∑–∏–Ω–∫–∞ —Å –∫–ª—É–±–Ω–∏–∫–æ–π —Å—Ç–æ–∏—Ç –Ω–∞ –∫—É—Ö–æ–Ω–Ω–æ–º —Å—Ç–æ–ª–µ.",
    "–ü—ë—Å —Ä–∞–¥–æ—Å—Ç–Ω–æ –≤–∏–ª—è–µ—Ç —Ö–≤–æ—Å—Ç–æ–º —É –≤–æ—Ä–æ—Ç.",
    "–ú—ã –≤–µ—à–∞–µ–º –º–æ–∫—Ä—ã–µ –∑–æ–Ω—Ç–∏–∫–∏ —Å—É—à–∏—Ç—å—Å—è –≤ –ø—Ä–∏—Ö–æ–∂–µ–π.",
    "–î–∞–Ω–∏–ª –æ–±—ä–µ–∑–∂–∞–µ—Ç –Ω–∞ –≤–µ–ª–æ—Å–∏–ø–µ–¥–µ –±–æ–ª—å—à—É—é –ª—É–∂—É.",
    "–î–µ—Ç–∏ —Ä–∏—Å—É—é—Ç –º–µ–ª–æ–º —Ä–∞–¥—É–≥—É –Ω–∞ –∞—Å—Ñ–∞–ª—å—Ç–µ.",
    "–ú–∞–ª—å—á–∏—à–∫–∏ –∏–≥—Ä–∞—é—Ç –≤ —Ñ—É—Ç–±–æ–ª —Å –Ω–æ–≤—ã–º –º—è—á–æ–º.",
    "–î–µ–≤–æ—á–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç –±—Ä–∞—Ç–∞ –∑–∞ —à—Ç–æ—Ä–æ–π –≤ –ø—Ä—è—Ç–∫–∞—Ö.",
    "–ú—ã–ª—å–Ω—ã–µ –ø—É–∑—ã—Ä–∏ –ø–µ—Ä–µ–ª–∏–≤–∞—é—Ç—Å—è –Ω–∞ —Å–æ–ª–Ω—Ü–µ.",
    "–Ø–±–ª–æ—á–Ω—ã–π –ø–∏—Ä–æ–≥ —Ä—É–º—è–Ω–∏—Ç—Å—è –≤ –¥—É—Ö–æ–≤–∫–µ.",
    "–ö–æ—Ç –∑–∞–ø—Ä—ã–≥–Ω—É–ª –Ω–∞ —Å—Ç–æ–ª –∑–∞ –∫—É—Å–æ—á–∫–æ–º —Å—ã—Ä–∞.",
    "–î–æ–∂–¥–µ–≤—ã–µ –∫–∞–ø–ª–∏ —Ç–∞–Ω—Ü—É—é—Ç –Ω–∞ –∂–µ–ª–µ–∑–Ω–æ–π –∫—Ä—ã—à–µ.",
    "–ë–∞–±—É—à–∫–∞ —Å—Ç–∞–≤–∏—Ç –ø–∏—Ä–æ–≥ —Å –≤–∏—à–Ω–µ–π –Ω–∞ –æ–∫–æ—à–∫–æ –æ—Å—Ç—ã–≤–∞—Ç—å.",
    "–û—Å–µ–Ω–Ω–∏–µ –ª–∏—Å—Ç—å—è –∫—Ä—É–∂–∞—Ç—Å—è –≤ –∑–æ–ª–æ—Ç–æ–º –≤–∏—Ö—Ä–µ.",
    "–í–æ–≤–∞ –ª–æ–≤–∏—Ç —Å–∞—á–∫–æ–º —è—Ä–∫—É—é –±–∞–±–æ—á–∫—É.",
    "–°–æ–±–∞–∫–∞ –±–µ–∂–∏—Ç –∑–∞ –º—è—á–æ–º –ø–æ –º–æ–∫—Ä–æ–π —Ç—Ä–∞–≤–µ.",
    "–í –Ω–æ—á–Ω–æ–π —Ç–∏—à–∏–Ω–µ —Å—Ç—Ä–µ–∫–æ—á—É—Ç –ª–µ—Å–Ω—ã–µ —Å–≤–µ—Ä—á–∫–∏.",
    "–ê–ª—ë–Ω–∞ —Ä–∏—Å—É–µ—Ç —Ä–∞–¥—É–≥—É –ø–æ—Å–ª–µ –¥–æ–∂–¥—è.",
    "–ü–∞–ø–∞ —á–∏–Ω–∏—Ç –ø—Ä–æ–∫–æ–ª–æ—Ç–æ–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥–Ω–æ–µ –∫–æ–ª–µ—Å–æ.",
    "–í —Å—Ç–∞—Ä–æ–π –∫–æ—Ä–æ–±–∫–µ –±–ª–µ—Å—Ç—è—Ç —Å—Ç–µ–∫–ª—è–Ω–Ω—ã–µ –±—É—Å–∏–Ω—ã.",
    "–£—Ç—Ä–µ–Ω–Ω–∏–π —Ç—É–º–∞–Ω —Å—Ç–µ–ª–µ—Ç—Å—è –Ω–∞–¥ —Ä–µ–∫–æ–π.",
    "–£—á–∏—Ç–µ–ª—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∏–∑–≤–µ—Ä–∂–µ–Ω–∏–µ —Å–∞–º–æ–¥–µ–ª—å–Ω–æ–≥–æ –≤—É–ª–∫–∞–Ω–∞.",
    "–ê–ª—å–ø–∏–Ω–∏—Å—Ç—ã –ø–æ–¥–Ω–∏–º–∞—é—Ç—Å—è –ø–æ –∫–∞–º–µ–Ω–∏—Å—Ç–æ–π —Ç—Ä–æ–ø–µ.",
    "–õ–µ–¥—è–Ω—ã–µ —Å–æ—Å—É–ª—å–∫–∏ —Å–≤–µ—Ä–∫–∞—é—Ç –Ω–∞ —É—Ç—Ä–µ–Ω–Ω–µ–º —Å–æ–ª–Ω—Ü–µ.",
    "–°—Ç–∞—Ä–∏–Ω–Ω–∞—è –∫–∞—Ä—Ç–∞ –ª–µ–∂–∏—Ç –≤ –∫–æ–∂–∞–Ω–æ–π –ø–∞–ø–∫–µ.",
    "–ë—É–º–∞–∂–Ω—ã–π –∫–æ—Ä–∞–±–ª–∏–∫ –ø–ª—ã–≤—ë—Ç –ø—Ä–æ—Ç–∏–≤ —Ç–µ—á–µ–Ω–∏—è —Ä—É—á—å—è.",
    "–õ—è–≥—É—à–∫–∞ –ø—Ä—ã–≥–∞–µ—Ç —Å –ª–∏—Å—Ç–∞ –∫—É–≤—à–∏–Ω–∫–∏ –≤ –ø—Ä—É–¥.",
    "–î–µ—Ç–∏ —Å—Ç—É—á–∞—Ç –ª–æ–∂–∫–∞–º–∏ –ø–æ –∂–µ–ª–µ–∑–Ω—ã–º –∫–∞—Å—Ç—Ä—é–ª—è–º.",
    "–°–Ω–µ–∂–æ–∫ –≤—Ä–µ–∑–∞–µ—Ç—Å—è –≤ —Å—Ç–≤–æ–ª —Å–æ—Å–Ω—ã.",
    "–î–µ–≤–æ—á–∫–∞ –ø—Ä—ã–≥–∞–µ—Ç –≤ –∫–ª–∞—Å—Å–∏–∫–∏ –Ω–∞ –∞—Å—Ñ–∞–ª—å—Ç–µ.",
    "–ú—É—Ä–∞–≤—å–∏–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ –¥–≤–∏–∂–µ—Ç—Å—è –∫ —Å–∞—Ö–∞—Ä–Ω–æ–π –∫—Ä–æ—à–∫–µ.",
    "–í –∫–∞–ø–ª–µ –≤–æ–¥—ã –ø–æ–¥ –º–∏–∫—Ä–æ—Å–∫–æ–ø–æ–º –ø–ª–∞–≤–∞—é—Ç –∏–Ω—Ñ—É–∑–æ—Ä–∏–∏.",
    "–°–µ–≤–µ—Ä–Ω–æ–µ —Å–∏—è–Ω–∏–µ –º–µ—Ä—Ü–∞–µ—Ç –Ω–∞–¥ –∑–∞—Å–Ω–µ–∂–µ–Ω–Ω—ã–º –ª–µ—Å–æ–º.",
    "–£—á—ë–Ω—ã–π –≤ –æ—á–∫–∞—Ö —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –∫—É—Å–æ–∫ –≤—É–ª–∫–∞–Ω–∏—á–µ—Å–∫–æ–π –ª–∞–≤—ã.",
    "–ß—ë—Ä–Ω—ã–µ –∫–æ—Ç—è—Ä–∞ –∏–≥—Ä–∞—é—Ç —Å –∫–ª—É–±–∫–æ–º —à–µ—Ä—Å—Ç–∏.",
    "–ë–µ–Ω–≥–∞–ª—å—Å–∫–∏–µ –æ–≥–Ω–∏ –∏—Å–∫—Ä—è—Ç—Å—è –≤ –Ω–æ–≤–æ–≥–æ–¥–Ω—é—é –Ω–æ—á—å.",
    "–§–µ–π–µ—Ä–≤–µ—Ä–∫ —Ä–∞—Å—Å—ã–ø–∞–µ—Ç—Å—è –∑–≤—ë–∑–¥–æ—á–∫–∞–º–∏ –Ω–∞–¥ –≥–æ—Ä–æ–¥–æ–º.",
    "–í–µ—Ç–µ—Ä –≥—É–¥–∏—Ç –≤ –ø–µ—á–Ω–æ–π —Ç—Ä—É–±–µ —Ö–æ–ª–æ–¥–Ω—ã–º –≤–µ—á–µ—Ä–æ–º.",
    "–°–æ—Å—É–ª—å–∫–∏ —Ç–∞—é—Ç, –∫–∞–ø–∞—è –Ω–∞ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫.",
    "–ú–∞–ª—å—á–∏–∫ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –∫–Ω–∏–≥—É –≤ –±–ª–µ—Å—Ç—è—â–µ–π –æ–±—ë—Ä—Ç–∫–µ.",
    "–¢—ë—Ç—è –¥–∞–ª–∞ –¢–∞–Ω–µ –≤–∫—É—Å–Ω—ã–π —Ç–æ—Ä—Ç.",
    "–î–∏–º–∞ –∏ –¢–∞–Ω—è –∏–¥—É—Ç –¥–æ–º–æ–π.",
    "–£ –¥–æ–º–∞ —Å—Ç–æ–∏—Ç –±–æ–ª—å—à–æ–π –¥—É–±.",
    "–î–µ–¥ —Ç–∏—Ö–æ —á–∏—Ç–∞–µ—Ç –¥–µ—Ç—è–º –∫–Ω–∏–≥—É.",
    "–¢–∞–Ω—è –≥–ª–∞–¥–∏—Ç –∫–æ—Ç–∞ –ø–æ —Å–ø–∏–Ω–µ.",
    "–î–µ—Ç–∏ –µ–¥—è—Ç —Å–ª–∞–¥–∫–∏–µ —Å–ø–µ–ª—ã–µ —Ñ—Ä—É–∫—Ç—ã.",
    "–î—è–¥—è –¢–æ–ª—è –≤–æ–¥–∏—Ç –∫—Ä–∞—Å–Ω—ã–π –∞–≤—Ç–æ–±—É—Å.",
    "–¢–æ–º–∞ –∏ –î–∏–º–∞ —Ä–∏—Å—É—é—Ç –¥–æ–º.",
    "–î–∞—à–∞ –¥–∞—Ä–∏—Ç –¢–∞–Ω–µ –∫—Ä–∞—Å–∏–≤—ã–π —Ü–≤–µ—Ç–æ–∫.",
    "–¢–∏–≥—Ä –≤ –∫–ª–µ—Ç–∫–µ –≥—Ä–æ–º–∫–æ —Ä—ã—á–∏—Ç.",
    "–î–æ–∂–¥—å —Å—Ç—É—á–∏—Ç –ø–æ –∫—Ä—ã—à–µ –¥–æ–º–∞.",
    "–¢—ë—Ç—è –î–∞—à–∞ –¥–µ–ª–∞–µ—Ç –≤–∫—É—Å–Ω—ã–π —Å—É–ø.",
    "–î–µ—Ç–∏ –≥—É–ª—è—é—Ç –≤ —Ç—ë–ø–ª—ã–π –¥–µ–Ω—å.",
    "–¢–∞–Ω—è –∏ –î–∏–º–∞ –∏–≥—Ä–∞—é—Ç –º—è—á–æ–º.",
    "–£ –î–∏–º—ã –µ—Å—Ç—å –¥–æ–±—Ä—ã–π –∫–æ—Ç.",
    "–¢–æ–Ω—è –µ—Å—Ç —Å–ª–∞–¥–∫—É—é —Å–ø–µ–ª—É—é –¥—ã–Ω—é.",
    "–î–µ–¥ –∏ –≤–Ω—É–∫ –∏–¥—É—Ç –≥—É–ª—è—Ç—å.",
    "–¢–∞–Ω—è –º–æ–µ—Ç —Ä—É–∫–∏ —Ç—ë–ø–ª–æ–π –≤–æ–¥–æ–π.",
    "–î–∏–º–∞ –¥–µ—Ä–∂–∏—Ç –≤ —Ä—É–∫–µ –∫–∞—Ä–∞–Ω–¥–∞—à.",
    "–¢—ë—Ç—è –∏ –¥—è–¥—è –µ–¥—É—Ç –¥–æ–º–æ–π."
]

LEVEL_NAMES = {
    1: "–°–ª–æ–≥–∏",
    2: "–°–ª–æ–≤–∞ –ø–æ —Å–ª–æ–≥–∞–º",
    3: "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç"
}

# –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—Ä–∞–∑—ã –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
SAMPLE_PHRASES = sorted(SAMPLE_PHRASES, key=lambda x: calculate_text_complexity(x))

STYLE = """
<style>
/* Target the specific button structure */
button[data-testid="stBaseButton-primary"] {
    background-color: #76c893 !important;
    border-color: #76c893 !important;
    color: white !important;
    transition: all 0.3s ease !important;
}

button[data-testid="stBaseButton-primary"]:hover {
    background-color: #5a9c6f !important;
    border-color: #5a9c6f !important;
}

/* Target the button's inner div */
button[data-testid="stBaseButton-primary"] > div {
    color: white !important;
}

/* Add focus state */
button[data-testid="stBaseButton-primary"]:focus {
    box-shadow: 0 0 0 0.2rem rgba(118, 200, 147, 0.5) !important;
    outline: none !important;
}

/* Card styling */
.phrase-card {
    border: 1px solid #e0e0e0;
    border-radius: 10px;
    padding: 1.5rem;
    margin-bottom: 1rem;
    transition: transform 0.2s;
}
.phrase-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

/* Progress bar */
.stProgress > div > div > div > div {
    background-color: #4CAF50 !important;
}

/* Word display */
.word-display {
    font-size: 96px;
    text-align: center;
    margin: 3rem 0;
    padding: 2rem;
    background: #f8f9fa;
    border-radius: 15px;
}

/* Rating buttons */
.rating-button {
    padding: 1rem 2rem !important;
    font-size: 1.2rem !important;
    transition: all 0.3s ease !important;
}
</style>
"""

def init_session_state():
    """Initialize session state variables"""
    if 'current_text' not in st.session_state:
        st.session_state.current_text = None
    if 'reading_state' not in st.session_state:
        st.session_state.reading_state = None
    if 'processed_result' not in st.session_state:
        st.session_state.processed_result = None
    if 'read_status' not in st.session_state:
        st.session_state.read_status = load_read_status()

def load_read_status():
    """Load read status from file"""
    if os.path.exists(READ_STATUS_FILE):
        with open(READ_STATUS_FILE, 'r', encoding='utf-8') as f:
            return json.load(f)
    return {phrase: False for phrase in SAMPLE_PHRASES}

def save_read_status():
    """Save read status to file"""
    with open(READ_STATUS_FILE, 'w', encoding='utf-8') as f:
        json.dump(st.session_state.read_status, f, ensure_ascii=False, indent=2)

def start_reading_session(text):
    """Initialize reading session"""
    try:
        result = process_text(text)
        if not result:
            raise ValueError("Invalid processing result")
            
        st.session_state.reading_state = {
            'current_level': 1,
            'levels': {
                1: {'words': result[1]['words'], 'progress': 0},
                2: {'words': result[2]['words'], 'progress': 0},
                3: {'words': result[3]['words'], 'progress': 0}
            },
            'stats': {
                'total_words': sum(len(level['words']) for level in result.values()),
                'good': 0,
                'medium': 0,
                'bad': 0
            }
        }
        st.session_state.current_text = text
    except Exception as e:
        logger.error(f"Error initializing session: {str(e)}")
        st.error("–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π —Ç–µ–∫—Å—Ç.")

def handle_rating(rating):
    """Process user rating and advance progress"""
    state = st.session_state.reading_state
    current_level = state['current_level']
    level_data = state['levels'][current_level]
    
    # Update stats
    state['stats'][rating] += 1
    
    # Advance to next word
    level_data['progress'] += 1
    
    # Check level completion
    if level_data['progress'] >= len(level_data['words']):
        if current_level < 3:
            state['current_level'] += 1
        else:
            # Calculate success rate
            success_rate = (state['stats']['good'] + state['stats']['medium'] * 0.5) / state['stats']['total_words']
            if success_rate >= 0.95:
                st.session_state.read_status[st.session_state.current_text] = True
                save_read_status()

def show_text_selection():
    """Display text selection screen"""
    st.markdown(STYLE, unsafe_allow_html=True)
    
    st.title("–¢—Ä–µ–Ω–∞–∂–µ—Ä —á—Ç–µ–Ω–∏—è")
    
    st.subheader("–ü—Ä–∏–º–µ—Ä—ã —Ç–µ–∫—Å—Ç–æ–≤")
    
    # Sample phrases grid
    for idx, phrase in enumerate(sorted(SAMPLE_PHRASES, key=lambda x: calculate_text_complexity(x))):
        with st.container(border=True):
            # Adjust column widths based on screen size
            cols = st.columns([4, 1.5, 1])  # Wider middle column for checkbox
            
            with cols[0]:
                st.markdown(f"\n{truncate_text(phrase, 100)}")
                st.caption(f"–°–ª–æ–∂–Ω–æ—Å—Ç—å: {calculate_text_complexity(phrase)}")
                
            with cols[1]:
                # Add checkbox with dynamic text
                is_read = st.session_state.read_status.get(phrase, False)
                checkbox_label = "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ" if is_read else "–ù–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ"
                
                # Use a unique key combining phrase and index
                unique_key = f"read_{idx}_{hash(phrase)}"
                new_status = st.checkbox(
                    checkbox_label,
                    value=is_read,
                    key=unique_key,
                    label_visibility="visible"
                )
                
                # Update status only if it changed
                if new_status != is_read:
                    st.session_state.read_status[phrase] = new_status
                    save_read_status()
                    st.rerun()
                
            with cols[2]:
                if is_read:
                    st.button(
                        "–°–Ω–æ–≤–∞",
                        key=f"ph_{idx}",
                        on_click=start_reading_session,
                        args=(phrase,),
                        type="secondary",
                        use_container_width=True
                    )
                else:
                    st.button(
                        "–ù–∞—á–∞—Ç—å",
                        key=f"ph_{idx}",
                        on_click=start_reading_session,
                        args=(phrase,),
                        type="primary",
                        use_container_width=True
                    )
    
    # Custom text input
    with st.expander("–í–≤–µ—Å—Ç–∏ —Å–≤–æ–π —Ç–µ–∫—Å—Ç", expanded=False):
        custom_text = st.text_area("–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç:", height=150)
        if st.button("–ù–∞—á–∞—Ç—å —á—Ç–µ–Ω–∏–µ", key="custom_start"):
            start_reading_session(custom_text)

def truncate_text(text, max_length):
    return text[:max_length] + "..." if len(text) > max_length else text

def show_reading_interface():
    """Display reading interface"""
    st.markdown(STYLE, unsafe_allow_html=True)
    state = st.session_state.reading_state
    current_level = state['current_level']
    level_data = state['levels'][current_level]
    
    # Progress header
    total_levels = 3
    # Fix progress calculation to ensure it stays between 0 and 1
    level_progress = level_data['progress'] / len(level_data['words'])
    progress = (current_level - 1) / total_levels + level_progress / total_levels
    progress = min(progress, 1.0)  # Ensure progress doesn't exceed 1.0
    
    st.progress(progress, text=f"–£—Ä–æ–≤–µ–Ω—å {current_level} –∏–∑ {total_levels} - {LEVEL_NAMES[current_level]}")
    
    # Word display
    if current_level <= 3 and level_data['progress'] < len(level_data['words']):
        current_word = level_data['words'][level_data['progress']]
        st.markdown(f'<div class="word-display">{current_word}</div>', unsafe_allow_html=True)
        
        # Rating buttons
        cols = st.columns(3)
        with cols[0]:
            st.button("ü§î –¢—Ä—É–¥–Ω–æ", 
                     on_click=handle_rating, args=('bad',), 
                     type="secondary", 
                     use_container_width=True)
        with cols[1]:
            st.button("üòê –°—Ä–µ–¥–Ω–µ", 
                     on_click=handle_rating, args=('medium',), 
                     type="secondary",
                     use_container_width=True)
        with cols[2]:
            st.button("üéâ –û—Ç–ª–∏—á–Ω–æ!", 
                     on_click=handle_rating, args=('good',), 
                     type="primary",
                     use_container_width=True)
        
        # Add return button
        st.button("‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—ã–±–æ—Ä—É —Ç–µ–∫—Å—Ç–∞", 
                 on_click=lambda: st.session_state.update({'reading_state': None, 'current_text': None}),
                 type="secondary",
                 use_container_width=True)
    else:
        show_results()

def show_results():
    """Display final results screen"""
    st.markdown(STYLE, unsafe_allow_html=True)
    state = st.session_state.reading_state
    
    st.title("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è")
    
    # Summary metrics
    cols = st.columns(3)
    with cols[0]:
        st.metric("–í—Å–µ–≥–æ —Å–ª–æ–≤", state['stats']['total_words'])
    with cols[1]:
        score = (state['stats']['good'] * 1 + state['stats']['medium'] * 0.5) / state['stats']['total_words'] * 10
        st.metric("–û–±—â–∏–π –±–∞–ª–ª", f"{score:.1f}/10")
    with cols[2]:
        st.metric("–ó–∞–≤–µ—Ä—à–µ–Ω–æ —É—Ä–æ–≤–Ω–µ–π", "3/3")
    
    # Detailed stats
    with st.expander("–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"):
        # Add rating statistics
        st.subheader("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –æ—Ü–µ–Ω–∫–∞–º")
        rating_cols = st.columns(3)
        with rating_cols[0]:
            st.metric("üéâ –û—Ç–ª–∏—á–Ω–æ", state['stats']['good'])
        with rating_cols[1]:
            st.metric("üòê –°—Ä–µ–¥–Ω–µ", state['stats']['medium'])
        with rating_cols[2]:
            st.metric("ü§î –¢—Ä—É–¥–Ω–æ", state['stats']['bad'])
        
        # Level progress
        for level in range(1, 4):
            st.subheader(f"–£—Ä–æ–≤–µ–Ω—å {level}: {LEVEL_NAMES[level]}")
            level_data = state['levels'][level]
            st.write(f"–ü—Ä–æ–≥—Ä–µ—Å—Å: {len(level_data['words'])}/{len(level_data['words'])} —Å–ª–æ–≤")
    
    # Navigation
    st.divider()
    col1, col2 = st.columns(2)
    with col1:
        if st.button("–ß–∏—Ç–∞—Ç—å –¥—Ä—É–≥–æ–π —Ç–µ–∫—Å—Ç", type="primary"):
            st.session_state.reading_state = None
            st.session_state.current_text = None
            st.rerun()

def main():
    init_session_state()
    
    if st.session_state.reading_state:
        show_reading_interface()
    else:
        show_text_selection()

if __name__ == "__main__":
    main()